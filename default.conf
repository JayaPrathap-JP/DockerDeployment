# Redirect HTTP requests from the server's IP to the application on port 9090
server {
    listen 80;  # Listening on port 80 for HTTP traffic
    server_name 15.207.254.171;  # The server's public IP

    location / {
        return 301 http://aws1.alchemdigital.com$request_uri;  # Redirect to the subdomain
    }
}

# Handle requests for the subdomain
server {
    listen 80;  # Listening on port 80 for HTTP traffic
    server_name aws1.alchemdigital.com;  # The DNS name (subdomain)

    location / {
        proxy_pass http://localhost:9090;  # Forward to the application running on port 9090
        proxy_set_header Host $host;  # Preserve the original host
        proxy_set_header X-Real-IP $remote_addr;  # Preserve the client's real IP
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;  # Forward the original client IP
        proxy_set_header X-Forwarded-Proto $scheme;  # Forward the original protocol (HTTP/HTTPS)
    }
}
